!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ACPosition=e():t.ACPosition=e()}(this,(function(){return(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>c});var o=function(t){return t.toString(16)},n=24,r=101.95,i=new RegExp(/^(?:Your location is: )?(0[xX][0-9a-fA-F]+) \[([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+)\] ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+)$/,"g"),a=new RegExp(/^(\d+(?:\.\d+)?[ns])(?:,\s{0,1}|\s{1})(\d+(?:\.\d+)?[ew])$/,"i");function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(l(this,t),!e)throw new Error("No objCellId provided");this.objCellId=Number(e),this.position=[r,i,a],this.rotation=[s,c,d,u],this.landblock=this.ObjCellId>>16,this.cellX=Math.trunc(((65535&e)-1)/8),this.cellY=Math.trunc(((65535&e)-1)%8),this.cell=this.cellX*n+this.cellY+1,this.landblockX=this.objCellId>>24&255,this.landblockY=this.objCellId>>16&255,this.globalCellX=8*this.landblockX+this.cellX,this.globalCellY=8*this.landblockY+this.cellY,this.objCellIdHex="0x"+o(this.objCellId).padStart(8,"0").toUpperCase(),this.landblockHex=o(this.landblock).padStart(4,"0").toUpperCase(),this.cellHex=o(this.cell).padStart(4,"0").toUpperCase()}var e,c,d;return e=t,d=[{key:"deserialize",value:function(e){if(!t.isValidLocString(e))throw new TypeError("Invalid Loc string");var o=i.exec(e);i.lastIndex=0;var n=o[1],r=[o[2],o[3],o[4]].map((function(t){return parseFloat(t,10)})),a=[o[5],o[6],o[7],o[8]].map((function(t){return parseFloat(t,10)}));return new t(n,r[0],r[1],r[2],a[0],a[1],a[2],a[3])}},{key:"fromRadar",value:function(e){if(!t.isValidRadar(e))throw new TypeError("Invalid radar coordinates");var o=a.exec(e);a.lastIndex=0;var i=parseFloat(o[2]),l=parseFloat(o[1]);(o[2].endsWith("W")||o[2].endsWith("w"))&&(i*=-1),(o[1].endsWith("S")||o[1].endsWith("s"))&&(l*=-1);var s=240*(i+r),c=240*(l+r),d=Math.trunc(s/n),u=Math.trunc(c/n),h=s%n,f=c%n,p=Math.trunc(h/n),b=Math.trunc(f/n),v=p*n+b+1,y=t.toObjCellId(d,u,v);return new t(y,h,f)}},{key:"fromGlobal",value:function(e,o){if(e>48960||e<0||o>48960||o<0)throw new RangeError("World coordinates are out of bounds");var r=e%192,i=o%192,a=Math.trunc(r/n),l=Math.trunc(i/n),s=a*n+l+1,c=Math.trunc(e/192),d=Math.trunc(o/192),u=t.toObjCellId(c,d,s);return new t(u,r,i)}},{key:"toObjCellId",value:function(t,e,o){if(!t&&!e&&!o)throw new Error("Invalid parameters");return(t<<24|e<<16|o)>>>0}},{key:"isValidLocString",value:function(t){var e=i.test(t);return i.lastIndex=0,e}},{key:"isValidRadar",value:function(t){var e=a.test(t);return a.lastIndex=0,e}}],(c=[{key:"originZ",get:function(){return this.position[2]},set:function(t){this.position[2]=t}},{key:"serialize",value:function(){var t=this.objCellIdHex,e=this.position.map((function(t){return Number(t).toFixed(6)})).join(" "),o=this.rotation.map((function(t){return Number(t).toFixed(6)})).join(" ");return"".concat(t," [").concat(e,"] ").concat(o)}},{key:"toRadar",value:function(t){var e=.1*(this.globalCellX-1024)+.5,o=.1*(this.globalCellY-1024)+.5,n=e>=0?Math.abs(e).toFixed(1)+"E":Math.abs(e).toFixed(1)+"W",r=o>=0?Math.abs(o).toFixed(1)+"N":Math.abs(o).toFixed(1)+"S";return t?[r,n]:"".concat(r,", ").concat(n)}},{key:"toGlobal",value:function(){return{x:192*this.landblockX+this.position[0],y:192*this.landblockY+this.position[1],z:this.position[2]}}}])&&s(e.prototype,c),d&&s(e,d),Object.defineProperty(e,"prototype",{writable:!1}),t}();return e.default})()}));