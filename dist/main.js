!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ACPosition=e():t.ACPosition=e()}(this,(function(){return(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>s});var o=function(t){return t.toString(16)},n=192,i=new RegExp(/^(?:Your location is: )?(0[xX][0-9a-fA-F]+) \[([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+)\] ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+) ([+-]?[0-9]+\.?[0-9]*|\.[0-9]+)$/,"g"),r=new RegExp(/^(\d+(?:\.\d+)?[ns])(?:,\s{0,1}|\s{1})(\d+(?:\.\d+)?[ew])$/,"i");function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(a(this,t),!e)throw new Error("No objCellId provided");this.objCellId=Number(e),this.position=[n,i,r],this.rotation=[l,s,c,d],this.landblock=this.objCellId>>16,this.cellX=Math.trunc(((65535&this.objCellId)-1)/8),this.cellY=Math.trunc(((65535&this.objCellId)-1)%8),this.cell=8*this.cellX+this.cellY+1,this.landblockX=this.objCellId>>24&255,this.landblockY=this.objCellId>>16&255,this.globalCellX=8*this.landblockX+this.cellX,this.globalCellY=8*this.landblockY+this.cellY,this.objCellIdHex="0x"+o(this.objCellId).padStart(8,"0").toUpperCase(),this.landblockHex=o(this.landblock).padStart(4,"0").toUpperCase(),this.cellHex=o(this.cell).padStart(4,"0").toUpperCase()}var e,s,c;return e=t,c=[{key:"deserialize",value:function(e){if(!t.isValidLocString(e))throw new TypeError("Invalid Loc string");var o=i.exec(e);i.lastIndex=0;var n=o[1],r=[o[2],o[3],o[4]].map((function(t){return parseFloat(t,10)})),a=[o[5],o[6],o[7],o[8]].map((function(t){return parseFloat(t,10)}));return new t(n,r[0],r[1],r[2],a[0],a[1],a[2],a[3])}},{key:"fromRadar",value:function(e){if(!t.isValidRadar(e))throw new TypeError("Invalid radar coordinates");var o=r.exec(e);r.lastIndex=0;var i=parseFloat(o[2]),a=parseFloat(o[1]);(o[2].endsWith("W")||o[2].endsWith("w"))&&(i*=-1),(o[1].endsWith("S")||o[1].endsWith("s"))&&(a*=-1);var l=240*(i+101.95),s=240*(a+101.95),c=Math.trunc(l/n),d=Math.trunc(s/n),u=l%n,h=s%n,f=8*Math.trunc(u/24)+Math.trunc(h/24)+1,b=t.toObjCellId(c,d,f);return new t(b,u,h)}},{key:"fromGlobal",value:function(e,o){if(e>48960||e<0||o>48960||o<0)throw new RangeError("World coordinates are out of bounds");var n=e%192,i=o%192,r=8*Math.trunc(n/24)+Math.trunc(i/24)+1,a=Math.trunc(e/192),l=Math.trunc(o/192),s=t.toObjCellId(a,l,r);return new t(s,n,i)}},{key:"toObjCellId",value:function(t,e,o){if(!t&&!e&&!o)throw new Error("Invalid parameters");return(t<<24|e<<16|o)>>>0}},{key:"isValidLocString",value:function(t){var e=i.test(t);return LOC_STRING_REGEXP.lastIndex=0,e}},{key:"isValidRadar",value:function(t){var e=r.test(t);return r.lastIndex=0,e}}],(s=[{key:"originZ",get:function(){return this.position[2]},set:function(t){this.position[2]=t}},{key:"serialize",value:function(){var t=this.objCellIdHex,e=this.position.map((function(t){return Number(t).toFixed(6)})).join(" "),o=this.rotation.map((function(t){return Number(t).toFixed(6)})).join(" ");return"".concat(t," [").concat(e,"] ").concat(o)}},{key:"toRadar",value:function(t){var e=.1*(this.globalCellX-1024)+.5,o=.1*(this.globalCellY-1024)+.5,n=e>=0?Math.abs(e).toFixed(1)+"E":Math.abs(e).toFixed(1)+"W",i=o>=0?Math.abs(o).toFixed(1)+"N":Math.abs(o).toFixed(1)+"S";return t?[i,n]:"".concat(i,", ").concat(n)}},{key:"toGlobal",value:function(){return{x:192*this.landblockX+this.position[0],y:192*this.landblockY+this.position[1],z:this.position[2]}}}])&&l(e.prototype,s),c&&l(e,c),Object.defineProperty(e,"prototype",{writable:!1}),t}();return e.default})()}));